<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="UMAPgp">
<title>umapgp-vignette • UMAPgp</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="umapgp-vignette">
<meta property="og:description" content="UMAPgp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">UMAPgp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/umapgp-vignette.html">umapgp-vignette</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>umapgp-vignette</h1>
            
      
      
      <div class="d-none name"><code>umapgp-vignette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="rationale">
<strong>Rationale</strong><a class="anchor" aria-label="anchor" href="#rationale"></a>
</h2>
<p>Uniform Manifold Approximation and Projection (UMAP) preserves local
structure by grouping neighboring data points together which provides an
informative visualization of heterogeneity in a dataset. However, if one
wants to understand the relationship between clusters of data points,
this can be troublesome since UMAP does not warrant that inter-cluster
distances are preserved correctly. To address this shortcoming, we have
created a package, UMAPgp which preserves the global structure of
manifold learning algorithms without losing the finer details. The
developed package is suited to process small datasets with approximately
5,000 data points.</p>
</div>
<div class="section level2">
<h2 id="significance-innovation">
<strong>Significance/ Innovation</strong><a class="anchor" aria-label="anchor" href="#significance-innovation"></a>
</h2>
<p>Preservation of global structure in manifold learning algorithms will
ensure that UMAP represents the big-picture while not losing the fine
details hence, better visualization. Based on the project results, we
created an R package that computes Uniform Manifold Approximation and
Projection (UMAP) while preserving global structures.</p>
<div class="section level3">
<h3 id="addressing-aim-1-and-aim-2">
<strong>Addressing Aim 1 and Aim 2</strong><a class="anchor" aria-label="anchor" href="#addressing-aim-1-and-aim-2"></a>
</h3>
<p>In this section, we shall load the required packages and import the
dataset ‘Iris’ which shall be used for the purpose of this project. We
will work towards visualizing the dataset alongwith preprocessing it to
perform UMAP. Additionally, we shall create the UMAP plot and check if
the distances and shape of the clusters have been preserved. This shall
address our Aim 1 and Aim 2.</p>
<div class="section level4">
<h4 id="loading-packages">
<em>Loading packages</em><a class="anchor" aria-label="anchor" href="#loading-packages"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tkonopka/umap" class="external-link">umap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">UMAPgp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="importing-dataset">
<em>Importing dataset</em><a class="anchor" aria-label="anchor" href="#importing-dataset"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"iris"</span><span class="op">)</span> </span>
<span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span><span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span></span>
<span><span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span></span>
<span><span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="a-plot-of-variables-of-interest">
<em>A plot of variables of interest</em><a class="anchor" aria-label="anchor" href="#a-plot-of-variables-of-interest"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Petal.Length</span>, y <span class="op">=</span> <span class="va">Petal.Width</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Petal Length"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Petal Width"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Species</span>,shape<span class="op">=</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'lm'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Iris Petal Length vs Width"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></span></code></pre></div>
<p><img src="umapgp-vignette_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="preprocessing-the-data-for-umap">
<em>Preprocessing the data for UMAP</em><a class="anchor" aria-label="anchor" href="#preprocessing-the-data-for-umap"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adding a unique row ID</span></span>
<span><span class="va">iris</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ID<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Creating a dataframe with all categorical variables with the unique row ID</span></span>
<span><span class="va">iris_meta</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">Species</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="performing-umap">
<em>Performing UMAP</em><a class="anchor" aria-label="anchor" href="#performing-umap"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">142</span><span class="op">)</span></span>
<span><span class="va">umap_fit</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/umap/man/umap.html" class="external-link">umap</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">umap_df</span> <span class="op">&lt;-</span> <span class="va">umap_fit</span><span class="op">$</span><span class="va">layout</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>UMAP1<span class="op">=</span><span class="st">"V1"</span>,</span>
<span>         UMAP2<span class="op">=</span><span class="st">"V2"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ID<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">iris</span>, by<span class="op">=</span><span class="st">"ID"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="umap-plot">
<em>UMAP Plot</em><a class="anchor" aria-label="anchor" href="#umap-plot"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">original_umap_plot</span> <span class="op">&lt;-</span> <span class="va">umap_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">UMAP1</span>, </span>
<span>             y <span class="op">=</span> <span class="va">UMAP2</span>, </span>
<span>             color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"UMAP1"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"UMAP2"</span>,</span>
<span>      subtitle <span class="op">=</span> <span class="st">"UMAP Plot"</span><span class="op">)</span></span>
<span><span class="va">original_umap_plot</span></span></code></pre></div>
<p><img src="umapgp-vignette_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="checking-aim-1">Checking Aim 1<a class="anchor" aria-label="anchor" href="#checking-aim-1"></a>
</h3>
<p>To quantify the global structure by establishing preservation of
distances between clusters.</p>
<div class="section level4">
<h4 id="correlation-of-original-with-reconstructed-distances-between-data-points">
<em>Correlation of original with reconstructed distances between
data points</em><a class="anchor" aria-label="anchor" href="#correlation-of-original-with-reconstructed-distances-between-data-points"></a>
</h4>
<p>Null hypothesis:- There is no correlation between original and
reconstructed distances between data points.</p>
<p>Alternative hypothesis:- There is correlation between original and
reconstructed distances between data points.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pearson is most appropriate for measurements taken from an interval scale</span></span>
<span><span class="co"># Spearman is more appropriate for measurements taken from ordinal scales.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Petal.Length</span>, <span class="va">umap_df</span><span class="op">$</span><span class="va">UMAP1</span>, method <span class="op">=</span> <span class="st">'pearson'</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  iris$Petal.Length and umap_df$UMAP1</span></span>
<span><span class="co">#&gt; t = -4.251, df = 148, p-value = 3.752e-05</span></span>
<span><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -0.4655218 -0.1790757</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;        cor </span></span>
<span><span class="co">#&gt; -0.3298703</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Petal.Width</span>, <span class="va">umap_df</span><span class="op">$</span><span class="va">UMAP2</span>, method <span class="op">=</span> <span class="st">'pearson'</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  iris$Petal.Width and umap_df$UMAP2</span></span>
<span><span class="co">#&gt; t = 19.127, df = 148, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.7904117 0.8844487</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;       cor </span></span>
<span><span class="co">#&gt; 0.8437884</span></span></code></pre></div>
<p>The result shows the p-value of less than 0.05 hence we reject the
null hypothesis and conclude that there is a correlation between
original and reconstructed distances between data points.</p>
</div>
<div class="section level4">
<h4 id="preservation-of-pairwise-mahalanobis-distances-between-clusters">
<em>Preservation of pairwise Mahalanobis distances between
clusters</em><a class="anchor" aria-label="anchor" href="#preservation-of-pairwise-mahalanobis-distances-between-clusters"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="va">umap_df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">D.sq</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">dbar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">S1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span></span>
<span>    <span class="va">S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span></span>
<span>    <span class="va">n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span></span>
<span>    <span class="va">n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span></span>
<span>    <span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n1</span> <span class="op">+</span> <span class="va">n2</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">n1</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">S1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="op">(</span><span class="va">n2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">S2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">D.sq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">dbar</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">dbar</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">res</span><span class="op">$</span><span class="va">D.sq</span> <span class="op">&lt;-</span> <span class="va">D.sq</span></span>
<span>    <span class="va">res</span><span class="op">$</span><span class="va">V</span> <span class="op">&lt;-</span> <span class="va">V</span></span>
<span>    <span class="va">res</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">D.sq</span><span class="op">(</span><span class="va">g1</span>,<span class="va">g2</span><span class="op">)</span></span>
<span><span class="co">#&gt; $D.sq</span></span>
<span><span class="co">#&gt;          [,1]</span></span>
<span><span class="co">#&gt; [1,] 4.738184</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $V</span></span>
<span><span class="co">#&gt;              Petal.Length Petal.Width</span></span>
<span><span class="co">#&gt; Petal.Length     4.084087   -3.368446</span></span>
<span><span class="co">#&gt; Petal.Width     -3.368446   17.213024</span></span></code></pre></div>
<p>The mahalanobis distance between clusters is 3.7158. We will
therefore aim to achieve mahalanobis Distance of 1 or lower so that the
data point are right among the benchmark points.</p>
</div>
</div>
<div class="section level3">
<h3 id="checking-aim-2">Checking Aim 2<a class="anchor" aria-label="anchor" href="#checking-aim-2"></a>
</h3>
<p>To investigate preservation of the shapes of the clusters as another
measure of global structure.</p>
<div class="section level4">
<h4 id="constructing-the-bounding-boxes">
<em>Constructing the bounding boxes</em><a class="anchor" aria-label="anchor" href="#constructing-the-bounding-boxes"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The bounding boxes around the original clusters</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Petal.Length</span>, y <span class="op">=</span> <span class="va">Petal.Width</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Petal Length"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Petal Width"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Iris Petal Length vs Width"</span><span class="op">)</span> <span class="op">+</span>   </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">0.8</span>, xmax <span class="op">=</span> <span class="fl">2.2</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>               fill <span class="op">=</span> <span class="st">"transparent"</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">2.7</span>, xmax <span class="op">=</span> <span class="fl">5.2</span>, ymin <span class="op">=</span> <span class="fl">0.8</span>, ymax <span class="op">=</span> <span class="fl">1.9</span><span class="op">)</span>,</span>
<span>               fill <span class="op">=</span> <span class="st">"transparent"</span>, color <span class="op">=</span> <span class="st">"green"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">4.4</span>, xmax <span class="op">=</span> <span class="fl">7.1</span>, ymin <span class="op">=</span> <span class="fl">1.2</span>, ymax <span class="op">=</span> <span class="fl">2.7</span><span class="op">)</span>,</span>
<span>               fill <span class="op">=</span> <span class="st">"transparent"</span>, color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="umapgp-vignette_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The bounding boxes around the reconstructed clusters</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">umap_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">UMAP1</span>, y <span class="op">=</span> <span class="va">UMAP2</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"UMAP1"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"UMAP2"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"UMAP Plot"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, xmax <span class="op">=</span> <span class="fl">0.0</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="fl">9</span>, ymax <span class="op">=</span> <span class="op">-</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>               fill <span class="op">=</span> <span class="st">"transparent"</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="op">-</span><span class="fl">2.5</span>, xmax <span class="op">=</span> <span class="fl">2.4</span>, ymin <span class="op">=</span> <span class="fl">0.5</span>, ymax <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span>,</span>
<span>               fill <span class="op">=</span> <span class="st">"transparent"</span>, color <span class="op">=</span> <span class="st">"green"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="op">-</span><span class="fl">2.0</span>, xmax <span class="op">=</span> <span class="fl">4.7</span>, ymin <span class="op">=</span> <span class="fl">0.6</span>, ymax <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span>,</span>
<span>               fill <span class="op">=</span> <span class="st">"transparent"</span>, color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="umapgp-vignette_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="pearson-correlation-coefficient-between-the-sizes-of-the-bounding-boxes">
<em>Pearson correlation coefficient between the sizes of the
bounding boxes</em><a class="anchor" aria-label="anchor" href="#pearson-correlation-coefficient-between-the-sizes-of-the-bounding-boxes"></a>
</h4>
<p>Null hypothesis:- There is no correlation between original and
reconstructed shapes of the clusters.</p>
<p>Alternative hypothesis:- There is correlation between original and
reconstructed shapes of the clusters.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">originalHeight</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">1.1</span>, <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">reconstructedHeight</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">4.9</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">originalHeight</span>, <span class="va">reconstructedHeight</span>, method <span class="op">=</span> <span class="st">'pearson'</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  originalHeight and reconstructedHeight</span></span>
<span><span class="co">#&gt; t = -2.117, df = 1, p-value = 0.2809</span></span>
<span><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;        cor </span></span>
<span><span class="co">#&gt; -0.9041944</span></span>
<span><span class="va">originalWidth</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.4</span>,<span class="fl">2.5</span>,<span class="fl">2.7</span><span class="op">)</span></span>
<span><span class="va">reconstructedWidth</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4.9</span>,<span class="fl">6.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></span><span class="op">(</span><span class="va">originalWidth</span>, <span class="va">reconstructedWidth</span>, method <span class="op">=</span> <span class="st">'pearson'</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  originalWidth and reconstructedWidth</span></span>
<span><span class="co">#&gt; t = 0.71014, df = 1, p-value = 0.6069</span></span>
<span><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;       cor </span></span>
<span><span class="co">#&gt; 0.5789983</span></span></code></pre></div>
<p>The result shows the p-value of 0.2809 and 0.6069 which are greater
than 0.05 hence we fail to reject the null hypothesis and conclude that
there is no correlation between original and reconstructed clusters. We
will therefore aim to achieve correlation between original and
reconstructed clusters.</p>
<p>The current UMAP package has a minimum distance of 0.5 and
n_neighbors of 15. Our UMAP package contains minimum distance of 0.3 and
n_neighbors of 70. Our package achieves preservation of global structure
in Uniform Manifold Approximation and Projection (UMAP) by :-</p>
<ol style="list-style-type: decimal">
<li>Attaining mahalanobis Distance of 1 so that the data point are right
among the benchmark points.</li>
<li>Accomplishing a correlation between the original and reconstructed
clusters.</li>
</ol>
</div>
</div>
</div>
<div class="section level2">
<h2 id="demonstration-of-how-to-use-the-function-umapgp">
<strong>Demonstration of how to use the function
‘UMAPgp’</strong><a class="anchor" aria-label="anchor" href="#demonstration-of-how-to-use-the-function-umapgp"></a>
</h2>
<p>This section shall involve defining our function and the parameters
to be passed. We shall preprocess the dataset for UMAP and create a
dataframe with all the categorical variables with the unique row ID. We
shall then perform UMAP and create the UMAP plot to demonstrate the
practical usage of the function <strong>UMAPgp</strong>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Defining the function and the parameters to be passed</span></span>
<span><span class="va">umapgp</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">var</span>,<span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="co"># Pre-processing the dataset for UMAP</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ID<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Creating a dataframe with all the categorical variables with the unique row ID</span></span>
<span>  <span class="va">data_meta</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">var</span><span class="op">)</span></span>
<span><span class="co"># Performing UMAP</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">142</span><span class="op">)</span></span>
<span>  <span class="va">umap_fit</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/umap/man/umap.html" class="external-link">umap</a></span><span class="op">(</span>n_neighbors<span class="op">=</span><span class="fl">70</span>,min_dist<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span>
<span>  <span class="va">umap_df</span> <span class="op">&lt;-</span> <span class="va">umap_fit</span><span class="op">$</span><span class="va">layout</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>UMAP1<span class="op">=</span><span class="st">"V1"</span>,</span>
<span>           UMAP2<span class="op">=</span><span class="st">"V2"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ID<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">data_meta</span>, by<span class="op">=</span><span class="st">"ID"</span><span class="op">)</span></span>
<span>  <span class="va">umap_df</span><span class="op">$</span><span class="va">var</span><span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span>, <span class="va">var</span><span class="op">]</span></span>
<span><span class="co"># Creating the UMAP Plot</span></span>
<span>  <span class="va">umapplot</span><span class="op">&lt;-</span><span class="va">umap_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">UMAP1</span>,</span>
<span>               y <span class="op">=</span> <span class="va">UMAP2</span>,</span>
<span>               color <span class="op">=</span> <span class="va">var</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"UMAP1"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"UMAP2"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"UMAP plot"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">umapplot</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="real-life-example">
<strong>Real-life example</strong><a class="anchor" aria-label="anchor" href="#real-life-example"></a>
</h2>
<p>We shall now use a different dataset ‘birds’ and apply our newly
developed package to the dataset to demonstrate the functionality of
umapgp. We shall also draw comparisons between the UMAP plots created
using the umap and the umapgp functions.</p>
<div class="section level3">
<h3 id="loading-the-dataset-and-creating-a-plot-of-variables-of-interest">
<em>Loading the dataset and creating a plot of variables of
interest</em><a class="anchor" aria-label="anchor" href="#loading-the-dataset-and-creating-a-plot-of-variables-of-interest"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Importing the dataset</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="co">##checking and reading the data</span></span>
<span><span class="va">fpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"birds.csv"</span>, package<span class="op">=</span><span class="st">"UMAPgp"</span><span class="op">)</span></span>
<span><span class="va">birds</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">fpath</span><span class="op">)</span></span>
<span><span class="va">birds</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id  huml humw ulnal ulnaw  feml femw  tibl tibw  tarl tarw           type</span></span>
<span><span class="co">#&gt; 1  0 80.78 6.68 72.01  4.88 41.81 3.70  5.50 4.03 38.70 3.84 Swimming Birds</span></span>
<span><span class="co">#&gt; 2  1 88.91 6.63 80.53  5.59 47.04 4.30 80.22 4.51 41.50 4.01 Swimming Birds</span></span>
<span><span class="co">#&gt; 3  2 79.97 6.37 69.26  5.28 43.07 3.90 75.35 4.04 38.31 3.34 Swimming Birds</span></span>
<span><span class="co">#&gt; 4  3 77.65 5.70 65.76  4.77 40.04 3.52 69.17 3.40 35.78 3.41 Swimming Birds</span></span>
<span><span class="co">#&gt; 5  4 62.80 4.84 52.09  3.73 33.95 2.72 56.27 2.96 31.88 3.13 Swimming Birds</span></span>
<span></span>
<span><span class="co"># A plot of variable of interest</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">birds</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">huml</span>, y <span class="op">=</span> <span class="va">humw</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Humurus Length"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Humurus Width"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">type</span>,shape<span class="op">=</span><span class="va">type</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'lm'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Birds Humurus Length vs Width"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></span></code></pre></div>
<p><img src="umapgp-vignette_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="performing-umap-1">
<em>Performing UMAP</em><a class="anchor" aria-label="anchor" href="#performing-umap-1"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Preprocessing the data for UMAP</span></span>
<span><span class="co"># Adding a unique row ID</span></span>
<span><span class="va">birds</span> <span class="op">&lt;-</span> <span class="va">birds</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Creating a dataframe with all categorical variables with the unique row ID</span></span>
<span><span class="va">Birds_meta</span> <span class="op">&lt;-</span> <span class="va">birds</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">type</span><span class="op">)</span></span>
<span><span class="co">## Performing UMAP</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">142</span><span class="op">)</span></span>
<span><span class="va">umap_fit</span> <span class="op">&lt;-</span> <span class="va">birds</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/umap/man/umap.html" class="external-link">umap</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">umap_df</span> <span class="op">&lt;-</span> <span class="va">umap_fit</span><span class="op">$</span><span class="va">layout</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>UMAP1<span class="op">=</span><span class="st">"V1"</span>,</span>
<span>         UMAP2<span class="op">=</span><span class="st">"V2"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">birds</span>, by<span class="op">=</span><span class="st">"id"</span><span class="op">)</span></span>
<span><span class="co">### UMAP Plot</span></span>
<span><span class="va">umap_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">UMAP1</span>, </span>
<span>             y <span class="op">=</span> <span class="va">UMAP2</span>, </span>
<span>             color <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"UMAP1"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"UMAP2"</span>,</span>
<span>      subtitle <span class="op">=</span> <span class="st">"UMAP plot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="umapgp-vignette_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="performing-umapgp">Performing UMAPgp<a class="anchor" aria-label="anchor" href="#performing-umapgp"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">UMAPgp</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/umapgp.html">umapgp</a></span><span class="op">(</span>var<span class="op">=</span><span class="st">"type"</span>, data<span class="op">=</span><span class="va">birds</span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: Using an external vector in selections is ambiguous.</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ℹ</span> Use `all_of(var)` instead of `var` to silence this message.</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ℹ</span> See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This message is displayed once per session.</span></span></span></code></pre></div>
<p><img src="umapgp-vignette_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>In conclusion, the UMAPgp package preserves the global structures
better compared to the original UMAP package.</p>
<div class="section level3">
<h3 id="references">
<strong>References</strong><a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Leland McInnes, John Healy &amp; James Melville UMAP: Uniform
Manifold Approximation and Projection for Dimension Reduction (<a href="https://arxiv.org/pdf/1802.03426.pdf" class="external-link uri">https://arxiv.org/pdf/1802.03426.pdf</a>)</li>
<li><a href="https://towardsdatascience.com/how-exactly-umap-works-13e3040e1668" class="external-link uri">https://towardsdatascience.com/how-exactly-umap-works-13e3040e1668</a></li>
<li><a href="https://towardsdatascience.com/why-umap-is-superior-over-tsne-faa039c28e99" class="external-link uri">https://towardsdatascience.com/why-umap-is-superior-over-tsne-faa039c28e99</a></li>
<li><a href="https://towardsdatascience.com/how-to-program-umap-from-scratch-e6eff67f55fe" class="external-link uri">https://towardsdatascience.com/how-to-program-umap-from-scratch-e6eff67f55fe</a></li>
<li><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8547469/" class="external-link uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8547469/</a></li>
</ol>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Beatrice Ngigi, Catherine Nderitu, Pujan Rijal.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
